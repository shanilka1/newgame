<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üî¢ ‡∑É‡∂Ç‡∂õ‡∑ä‚Äç‡∂∫‡∑è ‡∂¥‡∂Ø‡∑ä‡∂∞‡∂≠‡∑í 3D ‡∂Ö‡∂∑‡∑í‡∂∫‡∑ù‡∂ú‡∂∫</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom Styles -->
    <style>
        /* 3D ‡∂Ø‡∂ª‡∑ä‡∑Å‡∂±‡∂∫ ‡∑É‡∂≥‡∑Ñ‡∑è Canvas ‡∂ë‡∂ö ‡∂¥‡∑î‡∂ª‡∑è‡∂∏ ‡∂Ø‡∑í‡∂ú‡∑î ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ */
        #game-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 0; /* ‡∂¥‡∑É‡∑î‡∂∂‡∑í‡∂∏‡∂ß ‡∂∫‡∑ê‡∑Ä‡∑ì‡∂∏ */
        }
        /* UI ‡∂ë‡∂ö 3D ‡∂Ø‡∂ª‡∑ä‡∑Å‡∂±‡∂∫ ‡∂∏‡∂≠‡∂ß ‡∂ú‡∑ê‡∂±‡∑ì‡∂∏ */
        #ui-overlay {
            position: relative;
            z-index: 10; 
            min-height: 100vh;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <!-- 3D ‡∂Ø‡∂ª‡∑ä‡∑Å‡∂±‡∂∫ ‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∂± ‡∂ö‡∂±‡∑ä‡∂ß‡∑ö‡∂±‡∂ª‡∂∫ -->
    <div id="game-container"></div>

    <!-- ‡∂¥‡∂ª‡∑í‡∑Å‡∑ì‡∂Ω‡∂ö ‡∂Ö‡∂≠‡∑î‡∂ª‡∑î‡∂∏‡∑î‡∑Ñ‡∑î‡∂´‡∂≠ (UI) -->
    <div id="ui-overlay" class="p-4 flex flex-col items-center justify-start">
        <h1 class="text-4xl md:text-5xl font-extrabold mb-8 text-center bg-clip-text text-transparent bg-gradient-to-r from-yellow-400 to-red-500 py-2">
            üåå ‡∑É‡∂Ç‡∂õ‡∑ä‚Äç‡∂∫‡∑è ‡∂¥‡∂Ø‡∑ä‡∂∞‡∂≠‡∑í 3D ‡∂ã‡∑É‡∑É‡∑ä ‡∂ú‡∑Ä‡∑ö‡∑Ç‡∂´‡∂∫ 
        </h1>
        
        <!-- ‡∂ã‡∂¥‡∂Ø‡∑ô‡∑É‡∑ä ‡∑É‡∑Ñ ‡∂Ω‡∂ö‡∑î‡∂´‡∑î ‡∂¥‡∑ä‚Äç‡∂ª‡∂Ø‡∂ª‡∑ä‡∑Å‡∂±‡∂∫ -->
        <div class="w-full max-w-2xl bg-gray-800 bg-opacity-90 p-5 rounded-xl shadow-2xl border-2 border-blue-600">
            <div class="flex justify-between items-center">
                <p id="current-task" class="text-xl font-medium text-blue-300">‡∂Ü‡∂ª‡∂∏‡∑ä‡∂∑ ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂∂‡∑ú‡∂≠‡∑ä‡∂≠‡∂∏ ‡∂î‡∂∂‡∑è ‡∂ö‡∑ä‚Äç‡∂ª‡∑ì‡∂©‡∑è‡∑Ä ‡∂¥‡∂ß‡∂±‡∑ä ‡∂ú‡∂±‡∑ä‡∂±.</p>
                <p class="text-xl">‡∂Ω‡∂ö‡∑î‡∂´‡∑î: <span id="score" class="font-extrabold text-yellow-400">0</span></p>
            </div>
        </div>

        <!-- ‡∂Ü‡∂ª‡∂∏‡∑ä‡∂∑‡∂ö ‡∂≠‡∑í‡∂ª‡∂∫ -->
        <div id="start-screen" class="mt-20 text-center p-8 bg-gray-800 bg-opacity-90 rounded-lg shadow-2xl max-w-lg">
             <p class="mb-6 text-lg text-gray-300">‡∂Ø‡∑ä‡∑Ä‡∑í‡∂∏‡∂∫, ‡∂Ö‡∑Ç‡∑ä‡∂ß‡∂∏‡∂∫, ‡∂Ø‡∑Å‡∂∏‡∂∫ ‡∑É‡∑Ñ ‡∑Ç‡∂©‡∑Å‡∂∏‡∂∫ ‡∂Ö‡∂≠‡∂ª ‡∑É‡∑í‡∂∫‡∂Ω‡∑î‡∂∏ ‡∂¥‡∂ª‡∑í‡∑Ä‡∂ª‡∑ä‡∂≠‡∂± ‡∑É‡∑í‡∂Ø‡∑î‡∂ö‡∂ª ‡∂Ω‡∂ö‡∑î‡∂´‡∑î ‡∂Ω‡∂∂‡∑è ‡∂ú‡∂±‡∑ä‡∂±!</p>
             <button id="start-btn" class="bg-green-500 hover:bg-green-600 text-white font-extrabold text-2xl py-4 px-8 rounded-full shadow-lg transition transform hover:scale-105 active:scale-95">
                ‡∂ú‡∂∏‡∂± ‡∂Ö‡∂ª‡∂π‡∂∏‡∑î! (Start Advanced Game)
            </button>
        </div>

        <!-- ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª‡∑î ‡∂á‡∂≠‡∑î‡∂Ω‡∑ä ‡∂ö‡∂ª‡∂± ‡∂≠‡∑ê‡∂± -->
        <div id="input-area" class="mt-8 w-full max-w-md bg-gray-700 bg-opacity-95 p-6 rounded-xl shadow-2xl border border-gray-600 hidden">
            <label for="answer" class="block text-lg font-medium mb-3 text-gray-200">‡∂î‡∂∂‡∑ö ‡∂¥‡∂ª‡∑í‡∑Ä‡∂ª‡∑ä‡∂≠‡∂±‡∂∫ ‡∂á‡∂≠‡∑î‡∂Ω‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (Hex ‡∑É‡∂≥‡∑Ñ‡∑è Capitals ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±):</label>
            <input type="text" id="answer" class="w-full p-3 rounded-lg text-gray-900 focus:ring-4 focus:ring-blue-500 focus:border-blue-500 border-none" placeholder="‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª ‡∂∏‡∑ô‡∑Ñ‡∑í ‡∂á‡∂≠‡∑î‡∂Ω‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (‡∂ã‡∂Ø‡∑è: 1A)">
            <button id="submit-btn" class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition duration-300 transform hover:shadow-xl">
                ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª ‡∂â‡∂Ø‡∑í‡∂ª‡∑í‡∂¥‡∂≠‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
            </button>
        </div>
    </div>

    <!-- Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Three.js Orbit Controls (‡∂ö‡∑ê‡∂∏‡∂ª‡∑è‡∑Ä ‡∂ö‡∂ª‡∂ö‡∑ê‡∑Ä‡∑ì‡∂∏‡∂ß) -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    
    <!-- ‡∂¥‡∑ä‚Äç‡∂ª‡∂∞‡∑è‡∂± JavaScript ‡∂≠‡∂ª‡∑ä‡∂ö‡∂±‡∂∫ -->
    <script>
        // Global Variables
        let scene, camera, renderer, controls; // controls for orbiting the camera
        let score = 0;
        let currentChallenge = {};
        const gameContainer = document.getElementById('game-container');
        const scoreElement = document.getElementById('score');
        const taskElement = document.getElementById('current-task');
        const startScreen = document.getElementById('start-screen');
        const inputArea = document.getElementById('input-area');
        const startButton = document.getElementById('start-btn');
        const submitButton = document.getElementById('submit-btn');
        const answerInput = document.getElementById('answer');
        
        // Helper function to get base name
        function getBaseName(base) {
            switch (base) {
                case 2: return '‡∂Ø‡∑ä‡∑Ä‡∑í‡∂∏‡∂∫ (Binary)';
                case 8: return '‡∂Ö‡∑Ç‡∑ä‡∂ß‡∂∏‡∂∫ (Octal)';
                case 10: return '‡∂Ø‡∑Å‡∂∏‡∂∫ (Decimal)';
                case 16: return '‡∑Ç‡∂©‡∑Å‡∂∏‡∂∫ (Hexadecimal)';
                default: return '‡∂±‡∑ú‡∂Ø‡∂±‡∑ä‡∂±‡∑è ‡∂¥‡∂Ø‡∑ä‡∂∞‡∂≠‡∑í‡∂∫';
            }
        }

        // 3D ‡∂Ø‡∂ª‡∑ä‡∑Å‡∂±‡∂∫ ‡∂Ü‡∂ª‡∂∏‡∑ä‡∂∑ ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ (Updated for 4 bases)
        function initThreeJS() {
            // 1. ‡∂Ø‡∂ª‡∑ä‡∑Å‡∂±‡∂∫ (Scene)
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a0a20); // Darker space

            // 2. ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è‡∑Ä (Camera)
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 1, 5);

            // 3. ‡∂ª‡∑ô‡∂±‡∑ä‡∂©‡∂ª‡∂∫ (Renderer)
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            gameContainer.appendChild(renderer.domElement);
            
            // 4. Orbit Controls (‡∂ö‡∑ê‡∂∏‡∂ª‡∑è‡∑Ä ‡∂ö‡∂ª‡∂ö‡∑ê‡∑Ä‡∑ì‡∂∏‡∂ß)
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true; // ‡∑É‡∑î‡∂∏‡∂ß ‡∂†‡∂Ω‡∂±‡∂∫
            controls.dampingFactor = 0.05;

            // 5. ‡∂Ü‡∂Ω‡∑ù‡∂ö‡∂∫ (Lighting)
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5); 
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(5, 5, 5);
            scene.add(directionalLight);

            // 6. ‡∂¢‡∑ä‚Äç‡∂∫‡∑è‡∂∏‡∑í‡∂≠‡∑í‡∂∫ (Geometry) - ‡∑É‡∂Ç‡∂ö‡∂Ω‡∑ä‡∂¥‡∑ì‡∂∫ ‡∂≠‡∑ä‚Äç‡∂ª‡∑í‡∂∏‡∑è‡∂´ ‡∑Ä‡∑É‡∑ä‡∂≠‡∑î ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´‡∂∫
            
            // Base 10: Decimal Core (Sphere)
            const decimalGeometry = new THREE.SphereGeometry(1, 32, 32);
            const decimalMaterial = new THREE.MeshPhongMaterial({ 
                color: 0xff4500, // ‡∂ª‡∂≠‡∑î-‡∂≠‡∑ê‡∂π‡∑í‡∂Ω‡∑í
                emissive: 0x882200, 
                shininess: 100
            });
            const decimalSphere = new THREE.Mesh(decimalGeometry, decimalMaterial);
            decimalSphere.name = 'DecimalSystem';
            scene.add(decimalSphere);

            // Base 2: Binary Rings
            for (let i = 0; i < 4; i++) {
                const ringGeometry = new THREE.TorusGeometry(2 + i * 0.5, 0.05, 16, 100);
                const ringMaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00, wireframe: false });
                const ring = new THREE.Mesh(ringGeometry, ringMaterial);
                ring.rotation.x = Math.PI / 2;
                ring.rotation.y = i * 0.1;
                ring.name = `BinaryRing${i}`;
                scene.add(ring);
            }
            
            // Base 8: Octal Icosahedron
            const octalGeometry = new THREE.IcosahedronGeometry(0.5);
            const octalMaterial = new THREE.MeshPhongMaterial({ color: 0xffa500, wireframe: false, flatShading: true });
            const octalShape = new THREE.Mesh(octalGeometry, octalMaterial);
            octalShape.position.set(3, 0, 0);
            octalShape.name = 'OctalSystem';
            scene.add(octalShape);
            
            // Base 16: Hexadecimal Torus Knot
            const hexGeometry = new THREE.TorusKnotGeometry(0.5, 0.15, 100, 16);
            const hexMaterial = new THREE.MeshPhongMaterial({ color: 0x8a2be2, shininess: 150 });
            const hexShape = new THREE.Mesh(hexGeometry, hexMaterial);
            hexShape.position.set(-3, 0, 0);
            hexShape.name = 'HexSystem';
            scene.add(hexShape);
            
            // Window Resizing ‡∑Ñ‡∑ê‡∑É‡∑í‡∂ª‡∑Ä‡∑ì‡∂∏
            window.addEventListener('resize', onWindowResize, false);
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // ‡∂Ø‡∂ª‡∑ä‡∑Å‡∂±‡∂∫ ‡∑É‡∂¢‡∑ì‡∑Ä‡∑ì‡∂ö‡∂ª‡∂´‡∂∫ (Animation Loop)
        function animate() {
            requestAnimationFrame(animate);

            // 3D ‡∑Ä‡∑É‡∑ä‡∂≠‡∑ñ‡∂±‡∑ä ‡∂ö‡∂ª‡∂ö‡∑ê‡∑Ä‡∑ì‡∂∏
            const decimalSphere = scene.getObjectByName('DecimalSystem');
            if (decimalSphere) {
                decimalSphere.rotation.x += 0.003;
                decimalSphere.rotation.y += 0.005;
            }
            
            // ‡∂Ø‡∑ä‡∑Ä‡∑í‡∂∏‡∂∫ ‡∑Ä‡∑Ö‡∂Ω‡∑î ‡∂ö‡∂ª‡∂ö‡∑ê‡∑Ä‡∑ì‡∂∏
            for (let i = 0; i < 4; i++) {
                const ring = scene.getObjectByName(`BinaryRing${i}`);
                if (ring) {
                    ring.rotation.z += 0.007 + i * 0.001;
                }
            }
            
            const octalShape = scene.getObjectByName('OctalSystem');
            if (octalShape) {
                octalShape.rotation.x += 0.005;
                octalShape.rotation.z += 0.008;
            }
            
            const hexShape = scene.getObjectByName('HexSystem');
            if (hexShape) {
                hexShape.rotation.y += 0.009;
                hexShape.rotation.z += 0.004;
            }
            
            if (controls) {
                 controls.update(); // OrbitControls update
            }
           
            renderer.render(scene, camera);
        }

        // ----------------------------------------------------
        // ‡∑É‡∂Ç‡∂õ‡∑ä‚Äç‡∂∫‡∑è ‡∂¥‡∂Ø‡∑ä‡∂∞‡∂≠‡∑í ‡∂≠‡∂ª‡∑ä‡∂ö‡∂±‡∂∫ (Number Systems Logic)
        // ----------------------------------------------------
        
        // 3D ‡∑Ä‡∑É‡∑ä‡∂≠‡∑î ‡∂Ö‡∑Ä‡∂∞‡∑è‡∂ª‡∂´‡∂∫ ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∑ö ‡∑Å‡∑ä‚Äç‡∂ª‡∑í‡∂≠‡∂∫
        function highlightTargetShape(targetBase) {
            // ‡∑É‡∑í‡∂∫‡∂Ω‡∑ä‡∂Ω ‡∂∫‡∑Ö‡∑í ‡∑É‡∂ö‡∑É‡∂±‡∑ä‡∂±
            scene.getObjectByName('DecimalSystem').material.emissive.setHex(0x882200);
            const octalShape = scene.getObjectByName('OctalSystem');
            if (octalShape) {
                 octalShape.material.wireframe = false;
                 octalShape.material.color.setHex(0xffa500);
            }
            const hexShape = scene.getObjectByName('HexSystem');
            if (hexShape) hexShape.material.color.setHex(0x8a2be2);
            for (let i = 0; i < 4; i++) {
                const ring = scene.getObjectByName(`BinaryRing${i}`);
                if (ring) ring.material.color.setHex(0x00ff00);
            }

            // ‡∂â‡∂Ω‡∂ö‡∑ä‡∂ö ‡∂¥‡∂Ø‡∑ä‡∂∞‡∂≠‡∑í‡∂∫ ‡∂â‡∑É‡∑ä‡∂∏‡∂≠‡∑î ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
            switch (targetBase) {
                case 2:
                    // Binary Rings flash white
                    for (let i = 0; i < 4; i++) {
                        const ring = scene.getObjectByName(`BinaryRing${i}`);
                        if (ring) ring.material.color.setHex(0xffffff);
                    }
                    break;
                case 8:
                    // Octal Shape Wireframe on
                    if (octalShape) {
                        octalShape.material.wireframe = true;
                        octalShape.material.color.setHex(0x00ffff); // Cyan highlight
                    }
                    break;
                case 10:
                    // Decimal Core brightens
                    scene.getObjectByName('DecimalSystem').material.emissive.setHex(0xffaa00);
                    break;
                case 16:
                    // Hex Shape changes color
                    if (hexShape) hexShape.material.color.setHex(0xff00ff); // Magenta highlight
                    break;
            }
        }

        // ‡∂Ö‡∑Ñ‡∂π‡∑î ‡∂Ö‡∂∑‡∑í‡∂∫‡∑ù‡∂ú‡∂∫‡∂ö‡∑ä ‡∂¢‡∂±‡∂±‡∂∫ ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ (Updated for all conversions)
        function generateChallenge() {
            const bases = [2, 8, 10, 16];
            
            // Source Base and Target Base must be different
            let sourceBase, targetBase;
            do {
                sourceBase = bases[Math.floor(Math.random() * bases.length)];
                targetBase = bases[Math.floor(Math.random() * bases.length)];
            } while (sourceBase === targetBase);

            // Base 10 ‡∂Ö‡∂ú‡∂∫‡∂ö‡∑ä ‡∂¢‡∂±‡∂±‡∂∫ ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (100 ‡∑É‡∑í‡∂ß 1000 ‡∂Ö‡∂≠‡∂ª)
            const decimalValue = Math.floor(Math.random() * 900) + 100; 
            
            // ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂±‡∂∫ ‡∂¢‡∂±‡∂±‡∂∫ ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (Source Base ‡∂ë‡∂ö‡∂ß convert ‡∂ö‡∂ª‡∂±‡∑ä‡∂±)
            const questionValue = decimalValue.toString(sourceBase).toUpperCase();
            
            // ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª ‡∂¢‡∂±‡∂±‡∂∫ ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (Target Base ‡∂ë‡∂ö‡∂ß convert ‡∂ö‡∂ª‡∂±‡∑ä‡∂±)
            const correctAnswer = decimalValue.toString(targetBase).toUpperCase();

            currentChallenge = {
                question: questionValue,
                answer: correctAnswer,
                sourceBase: sourceBase,
                targetBase: targetBase,
                sourceBaseName: getBaseName(sourceBase),
                targetBaseName: getBaseName(targetBase)
            };
            
            taskElement.textContent = `üö® ‡∂Ö‡∂∑‡∑í‡∂∫‡∑ù‡∂ú‡∂∫: ${questionValue} (${sourceBase}) ‡∂Ö‡∂Ç‡∂ö‡∂∫ ${currentChallenge.targetBaseName} (${targetBase}) ‡∑Ä‡∂Ω‡∂ß ‡∑Ñ‡∂ª‡∑Ä‡∂±‡∑ä‡∂±.`;
            answerInput.value = '';
            answerInput.focus();

            // 3D Visual Feedback for the Target Base
            highlightTargetShape(targetBase);
        }

        // ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª‡∑î ‡∂â‡∂Ø‡∑í‡∂ª‡∑í‡∂¥‡∂≠‡∑ä ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∑Ñ‡∑ê‡∑É‡∑í‡∂ª‡∑Ä‡∑ì‡∂∏ (Updated for all conversions)
        function handleSubmit() {
            // Input is trimmed and converted to UPPERCASE to match Hex answers (A-F)
            const userAnswer = answerInput.value.trim().toUpperCase();
            const decimalSphere = scene.getObjectByName('DecimalSystem');
            
            if (!userAnswer) {
                taskElement.textContent = '‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª‡∂ö‡∑ä ‡∂á‡∂≠‡∑î‡∂Ω‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.';
                return;
            }
            
            const targetBase = currentChallenge.targetBase;
            let isValidInput = true;
            
            // Input Validation check for the target base's expected format
            const regexMap = {
                2: /^[01]+$/,
                8: /^[0-7]+$/,
                10: /^[0-9]+$/,
                16: /^[0-9A-F]+$/
            };
            
            if (regexMap[targetBase] && !regexMap[targetBase].test(userAnswer)) {
                isValidInput = false;
            }
            
            // Check if the answer matches AND if the format is valid
            if (userAnswer === currentChallenge.answer && isValidInput) {
                score += 15;
                // ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í: ‡∂ö‡∑ú‡∑Ö ‡∂¥‡∑è‡∂ß‡∂ß Flash ‡∑Ä‡∑ì‡∂∏
                decimalSphere.material.emissive.setHex(0x00ff00); 
                taskElement.classList.remove('text-blue-300', 'text-red-400');
                taskElement.classList.add('text-green-400');
                taskElement.textContent = `‚úÖ ‡∂±‡∑í‡∂∫‡∂∏‡∂∫‡∑í! ${currentChallenge.question} (${currentChallenge.sourceBase}) = ${currentChallenge.answer} (${currentChallenge.targetBase}). ‡∂Ω‡∂ö‡∑î‡∂´‡∑î +15.`;
                
                setTimeout(() => {
                    decimalSphere.material.emissive.setHex(0x882200); // ‡∑Ä‡∂ª‡∑ä‡∂´‡∂∫ ‡∂∫‡∑Ö‡∑í ‡∑É‡∂ö‡∑É‡∂±‡∑ä‡∂±
                    taskElement.classList.remove('text-green-400');
                    taskElement.classList.add('text-blue-300');
                    generateChallenge();
                }, 1500);
                
            } else {
                score = Math.max(0, score - 5); // ‡∂Ω‡∂ö‡∑î‡∂´‡∑î 0 ‡∂ß ‡∑Ä‡∂©‡∑è ‡∂Ö‡∂©‡∑î‡∑Ä‡∑ì‡∂∏ ‡∂±‡∑Ä‡∂≠‡∑ä‡∑Ä‡∂∫‡∑í
                // ‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í: ‡∂ª‡∂≠‡∑î ‡∂¥‡∑è‡∂ß‡∂ß Flash ‡∑Ä‡∑ì‡∂∏
                decimalSphere.material.emissive.setHex(0xff0000); 
                taskElement.classList.remove('text-blue-300', 'text-green-400');
                taskElement.classList.add('text-red-400');
                
                if (!isValidInput) {
                     taskElement.textContent = `‚ùå ‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í‡∂∫‡∑í! ‡∂î‡∂∂ ‡∂á‡∂≠‡∑î‡∑Ö‡∂≠‡∑ä ‡∂ö‡∑Ö ‡∂Ö‡∂ú‡∂∫ ${currentChallenge.targetBase} ‡∂¥‡∂Ø‡∑ä‡∂∞‡∂≠‡∑í‡∂∫‡∑ö ‡∂Ü‡∂ö‡∑ò‡∂≠‡∑í‡∂∫‡∂ß ‡∂ú‡∑ê‡∂Ω‡∂¥‡∑ô‡∂±‡∑ä‡∂±‡∑ö ‡∂±‡∑ê‡∑Ñ‡∑ê.`;
                } else {
                     taskElement.textContent = `‚ùå ‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í‡∂∫‡∑í! ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª: ${currentChallenge.answer} (${currentChallenge.targetBase}). ‡∂Ω‡∂ö‡∑î‡∂´‡∑î -5.`;
                }

                setTimeout(() => {
                    decimalSphere.material.emissive.setHex(0x882200); // ‡∑Ä‡∂ª‡∑ä‡∂´‡∂∫ ‡∂∫‡∑Ö‡∑í ‡∑É‡∂ö‡∑É‡∂±‡∑ä‡∂±
                    taskElement.classList.remove('text-red-400');
                    taskElement.classList.add('text-blue-300');
                    generateChallenge();
                }, 3000);
            }
            
            scoreElement.textContent = score;
        }

        // ----------------------------------------------------
        // Event Listeners
        // ----------------------------------------------------

        // ‡∂ö‡∑ä‚Äç‡∂ª‡∑ì‡∂©‡∑è‡∑Ä ‡∂Ü‡∂ª‡∂∏‡∑ä‡∂∑ ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏
        startButton.addEventListener('click', () => {
            // Three.js ‡∂Ü‡∂ª‡∂∏‡∑ä‡∂∑ ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∂ß ‡∂¥‡∑ô‡∂ª OrbitControls ‡∂¥‡∑ñ‡∂ª‡∂´‡∂∫ ‡∑Ä‡∑ì ‡∂á‡∂≠‡∑í ‡∂∂‡∑Ä‡∂ß ‡∑É‡∑Ñ‡∂≠‡∑í‡∂ö ‡∑Ä‡∑ì‡∂∏
            if (typeof THREE.OrbitControls === 'undefined') {
                taskElement.textContent = '3D ‡∂¥‡∑î‡∑É‡∑ä‡∂≠‡∂ö‡∑è‡∂Ω‡∂∫ ‡∂¥‡∑ñ‡∂ª‡∂´‡∂∫ ‡∑Ä‡∑ô‡∂∏‡∑í‡∂±‡∑ä ‡∂¥‡∑Ä‡∂≠‡∑ì... ‡∂∏‡∑ú‡∑Ñ‡∑ú‡∂≠‡∂ö‡∑ä ‡∂ª‡∑ê‡∂≥‡∑ì ‡∑É‡∑í‡∂ß‡∑í‡∂±‡∑ä‡∂±.';
                return; 
            }
            
            startScreen.classList.add('hidden');
            inputArea.classList.remove('hidden');
            
            // 3D ‡∂Ø‡∂ª‡∑ä‡∑Å‡∂±‡∂∫ ‡∑É‡∑Ñ ‡∑É‡∂¢‡∑ì‡∑Ä‡∑ì‡∂ö‡∂ª‡∂´‡∂∫ ‡∂Ü‡∂ª‡∂∏‡∑ä‡∂∑ ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏
            initThreeJS();
            animate();
            
            // ‡∂¥‡∑Ö‡∂∏‡∑î ‡∂Ö‡∂∑‡∑í‡∂∫‡∑ù‡∂ú‡∂∫ ‡∂¢‡∂±‡∂±‡∂∫ ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏
            generateChallenge();
        });

        // ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª ‡∂â‡∂Ø‡∑í‡∂ª‡∑í‡∂¥‡∂≠‡∑ä ‡∂ö‡∂ª‡∂± ‡∂∂‡∑ú‡∂≠‡∑ä‡∂≠‡∂∏
        submitButton.addEventListener('click', handleSubmit);

        // Enter key ‡∂ë‡∂ö ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∂∫‡∑ô‡∂±‡∑ä ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª ‡∂â‡∂Ø‡∑í‡∂ª‡∑í‡∂¥‡∂≠‡∑ä ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∂ß
        answerInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                handleSubmit();
            }
        });

        // ‡∂Ü‡∂ª‡∂∏‡∑ä‡∂∑‡∂∫‡∑ö‡∂Ø‡∑ì UI ‡∂ë‡∂ö ‡∑É‡∑ñ‡∂Ø‡∑è‡∂±‡∂∏‡∑ä ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ 
        document.addEventListener('DOMContentLoaded', () => {
            taskElement.textContent = '‡∂Ü‡∂ª‡∂∏‡∑ä‡∂∑ ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∂ß "‡∂ú‡∂∏‡∂± ‡∂Ö‡∂ª‡∂π‡∂∏‡∑î!" ‡∂î‡∂∂‡∂±‡∑ä‡∂±. ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è‡∑Ä ‡∂ö‡∂ª‡∂ö‡∑ê‡∑Ä‡∑ì‡∂∏‡∂ß ‡∂∏‡∑ñ‡∑É‡∑í‡∂ö‡∂∫ ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.';
        });
    </script>
</body>
</html>